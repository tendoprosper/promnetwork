<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Your Cart</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #121212;
      color: #f0f0f0;
      padding: 30px;
      margin: 0;
    }

    h1 {
      text-align: center;
      color: #62ff00;
      margin-bottom: 30px;
    }

    .cart-item {
      background: #1f1f1f;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 0 10px #000;
    }

    .cart-item h3 {
      margin: 0 0 10px;
      color: #d400ff;
    }

    .cart-item p {
      margin: 5px 0;
    }

    .cart-item input[type="number"] {
      width: 50px;
      padding: 5px;
      border-radius: 5px;
      border: none;
    }

    .cart-item button {
      background-color: crimson;
      color: white;
      border: none;
      padding: 6px 12px;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 10px;
    }

    .total {
      font-size: 1.5em;
      margin-top: 30px;
      text-align: right;
      color: #0bff03;
    }

    .checkout-btn {
      display: block;
      margin: 30px auto;
      padding: 12px 30px;
      background-color: #0bff03;
      color: #000;
      font-size: 1.2em;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .checkout-btn:hover {
      background-color: #62ff00;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Your Cart</h1>
  <div id="cart-items"></div>

  <div class="total">
    Total: UGX <span id="total-price">0</span>
  </div>

  <!-- Hidden form to submit to Formspree -->
  <form id="cart-form" action="https://formspree.io/f/xqapnljg" method="POST" class="hidden">
    <input type="hidden" name="cartData" id="cartData" />
  </form>
s
  <button class="checkout-btn" onclick="submitCart()">Proceed to Checkout</button>

  <script>
    function formatPrice(value) {
      return value.toLocaleString('en-UG', { minimumFractionDigits: 0 });
    }

    function loadCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const cartContainer = document.getElementById('cart-items');
      const totalPriceElement = document.getElementById('total-price');

      cartContainer.innerHTML = '';
      let totalPrice = 0;

      cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        totalPrice += itemTotal;

        const cartItemDiv = document.createElement('div');
        cartItemDiv.classList.add('cart-item');
        cartItemDiv.innerHTML = `
          <h3>${item.name}</h3>
          <p>Price: UGX ${formatPrice(item.price)}</p>
          <p>
            Quantity: 
            <input type="number" min="1" value="${item.quantity}" onchange="updateQuantity(${index}, this.value)" />
          </p>
          <p>Total: UGX ${formatPrice(itemTotal)}</p>
          <button onclick="removeFromCart('${item.name}')">Remove</button>
        `;
        cartContainer.appendChild(cartItemDiv);
      });

      totalPriceElement.textContent = formatPrice(totalPrice);
    }

    function updateQuantity(index, newQty) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart[index].quantity = parseInt(newQty);
      localStorage.setItem('cart', JSON.stringify(cart));
      loadCart();
    }

    function removeFromCart(productName) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart = cart.filter(item => item.name !== productName);
      localStorage.setItem('cart', JSON.stringify(cart));
      loadCart();
    }

    function submitCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
      }

      let total = 0;
      let cartText = `Customer Order Summary:\n\n`;

      cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        cartText += `Product: ${item.name}\nPrice: UGX ${formatPrice(item.price)}\nQuantity: ${item.quantity}\nItem Total: UGX ${formatPrice(itemTotal)}\n\n`;
      });

      cartText += `TOTAL: UGX ${formatPrice(total)}\n\nThank you for choosing TendoSTech!`;

      document.getElementById("cartData").value = cartText;

      // Submit the form
      document.getElementById("cart-form").submit();
    }

    window.onload = loadCart;
  </script>
</body>
</html>
